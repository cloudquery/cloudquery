// Code generated by codegen; DO NOT EDIT.

package {{ .Service }}

import (
	"context"

	"github.com/Azure/azure-sdk-for-go/sdk/azcore/arm"
	"github.com/cloudquery/cloudquery/plugins/source/azure/client"
	"github.com/cloudquery/plugin-sdk/schema"
	{{ .StructPackageName }} "{{ .StructPackage }}"
	{{- with .Parent }}
		{{ template "fetch_parent_import.go.tpl" . }}
	{{ end -}}
)

func fetch{{ .SubService | ToCamel }}(ctx context.Context, meta schema.ClientMeta, parent *schema.Resource, res chan<- any) error {
	c := meta.(*client.Client)
	svc := c.Services().{{ .Fetcher.Service }}

	{{ with .Parent }}
		{{ template "fetch_parents.go.tpl" .}}
	id, err := arm.ParseResourceID(*{{ .Resource.SubService | Singular | ToLowerCamel }}.ID)
	if err != nil {
		return err
	}
	{{- end }}

	{{ with  .Fetcher }}
		{{- range .ExtraValues }}res <- {{ . }} {{- end }}
		{{ if .IsPager }}
			{{ template "fetch_pager.go.tpl" . }}
		{{ else }}
			{{ if .IsList }}
				{{ template "fetch_list.go.tpl" . }}
			{{ else }}
				{{ template "fetch_get.go.tpl" . }}
			{{ end -}}
		{{ end -}}
	{{ end }}
	return nil
}

{{ template "fetch_preresolver.go.tpl" . }}
