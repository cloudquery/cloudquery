kind: source
spec:
  # Source spec section
  name: awscost
  registry: grpc
  path: localhost:7777
  # path: cloudquery/awscost
  # version: v16.3.0

  deterministic_cq_id: true
  tables: 
    - "awscost_costexplorer_cost_custom"
  destinations: [ "postgresql"]
  # concurrency: 100
  spec: 
    initialization_concurrency: 500
    # org:
    #   admin_account:
    #     id: test
    #     local_profile: cloudquery-root
    #   member_role_name: OrganizationAccountAccessRole
    cost_usage:
      - Granularity: DAILY
        Metrics: [ AmortizedCost, BlendedCost, NetAmortizedCost, NetUnblendedCost, NormalizedUsageAmount, UnblendedCost, UsageQuantity ]
        TimePeriod:
          Start: 2023-01-01
          End: 2023-01-31        
---
kind: destination
spec:
  # pk_mode: cq-id-only
  name: "postgresql"
  registry: "github"
  path: "cloudquery/postgresql"
  version: "v3.0.3"
  # registry: grpc
  # path: localhost:7778
  migrate_mode: forced
  spec:
    connection_string: "postgresql://postgres:pass@localhost:5432/postgres?sslmode=disable"





